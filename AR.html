<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Experiencia AR - Kiosco Guadua</title>
    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.4.0/model-viewer.min.js"></script>
    <style>
        body { margin: 0; padding: 0; background-color: #ffffff; font-family: 'Helvetica', sans-serif; height: 100vh; width: 100vw; overflow: hidden; }
        model-viewer { width: 100%; height: 100%; --poster-color: transparent; }
        
        /* Estilo Botón Starck (Minimalista) */
        #ar-button {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #000000;
            color: white;
            padding: 15px 30px;
            border-radius: 50px;
            border: none;
            font-size: 16px;
            font-weight: bold;
            letter-spacing: 0.5px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 100;
            white-space: nowrap;
        }
        
        /* Pantalla de carga limpia */
        #loader {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            display: flex; justify-content: center; align-items: center;
            background: white;
            z-index: 50;
            transition: opacity 0.5s;
            pointer-events: none;
        }
    </style>
</head>
<body>

    <div id="loader">
        <svg width="40" height="40" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <style>.spinner_P7sC{transform-origin:center;animation:spinner_svv2 .75s infinite linear}@keyframes spinner_svv2{100%{transform:rotate(360deg)}}</style>
            <path d="M10.14,1.16a11,11,0,0,0-9,8.92A1.59,1.59,0,0,0,2.46,12,1.52,1.52,0,0,0,4.11,10.7a8,8,0,0,1,6.66-6.61A1.42,1.42,0,0,0,12,2.69h0A1.57,1.57,0,0,0,10.14,1.16Z" class="spinner_P7sC"/>
        </svg>
    </div>

    <model-viewer
        id="viewer"
        src="https://ikdorsjntqnnxrpgvwrl.supabase.co/storage/v1/object/public/public-assets/kiosco-3d/P00.glb"
        ios-src="https://ikdorsjntqnnxrpgvwrl.supabase.co/storage/v1/object/public/public-assets/kiosco-3d/P00.glb"
        ar
        ar-modes="webxr scene-viewer quick-look"
        camera-controls
        auto-rotate
        shadow-intensity="1"
        autoplay
    >
        <button slot="ar-button" id="ar-button">
            Ver en tu espacio
        </button>
    </model-viewer>

    <script>
        const viewer = document.querySelector('#viewer');
        const loader = document.querySelector('#loader');

        // Ocultar loader cuando el modelo carga
        viewer.addEventListener('load', () => {
            loader.style.opacity = '0';
            
            // INTENTO DE AUTO-LANZAMIENTO AR (Funciona en algunos Androids modernos)
            // Si falla, el usuario tiene el botón gigante negro para pulsarlo.
            setTimeout(() => {
                if (viewer.canActivateAR) {
                    try {
                        viewer.activateAR();
                    } catch (error) {
                        console.log("Auto-AR prevenido por el navegador, esperando click manual.");
                    }
                }
            }, 500);
        });
    </script>
</body>
</html>